import os
from swbutils.common.Utils import get_process_info

class MongoUtil:
    
    @staticmethod
    def GetBaseMongoDir(tmpfromprefs = None):

        if not tmpfromprefs is None and os.path.exists(tmpfromprefs):
            dir = tmpfromprefs  + "/"
        elif "STDB" in os.environ and os.environ["STDB"] != "":
            dir = os.environ["STDB"] + "/tmp/"  
        else:
            dir = "/tmp/"
        return dir

    @staticmethod
    def GetDecoratedPath(includepname = False):
        pinfo = get_process_info()
        dpath = ""
        if includepname:
            dpath = pinfo["pname"] + '_'
        
        dpath = dpath + f'{pinfo["username"]}_{pinfo["host"]}_{pinfo["pid"]}'
        return dpath
        
    @staticmethod
    def IsMetaDbDebugEnabled():

        debugmode = False
        if "SWB_METADATA_PYTHON_DEBUG" in os.environ:
            debugmode = bool(os.environ["SWB_METADATA_PYTHON_DEBUG"] == '1')

        return debugmode